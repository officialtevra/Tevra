<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Memory Card Style File Explorer</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
  
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    padding: 20px;
    min-height: 100vh;
    color: #333;
    line-height: 1.6;
  }
  
  .container {
    max-width: 1200px;
    margin: 0 auto;
    background: rgba(255, 255, 255, 0.95);
    border-radius: 20px;
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
    overflow: hidden;
    backdrop-filter: blur(10px);
  }
  
  header {
    background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
    color: white;
    padding: 25px 30px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    position: relative;
    overflow: hidden;
  }
  
  header::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
    transform: rotate(30deg);
  }
  
  .header-left {
    display: flex;
    align-items: center;
    gap: 20px;
    z-index: 1;
  }
  
  .logo {
    width: 50px;
    height: 50px;
    background: white;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
  }
  
  .logo i {
    font-size: 24px;
    color: #3498db;
  }
  
  header h1 {
    font-size: 28px;
    font-weight: 700;
  }
  
  .header-stats {
    display: flex;
    gap: 25px;
    z-index: 1;
  }
  
  .stat {
    text-align: center;
  }
  
  .stat-value {
    font-size: 24px;
    font-weight: 700;
    color: #f1c40f;
  }
  
  .stat-label {
    font-size: 12px;
    opacity: 0.8;
    margin-top: 5px;
  }
  
  .action-buttons {
    display: flex;
    gap: 12px;
    z-index: 1;
  }
  
  .action-btn {
    background: rgba(255, 255, 255, 0.2);
    color: white;
    border: 2px solid rgba(255, 255, 255, 0.3);
    padding: 10px 20px;
    border-radius: 50px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    font-weight: 600;
    transition: all 0.3s;
    backdrop-filter: blur(10px);
  }
  
  .action-btn:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
  }
  
  .action-btn.back-btn {
    background: rgba(52, 152, 219, 0.7);
  }
  
  .breadcrumb {
    background: #f8f9fa;
    padding: 18px 30px;
    font-size: 16px;
    color: #6c757d;
    border-bottom: 1px solid #e9ecef;
    display: flex;
    align-items: center;
    gap: 12px;
    flex-wrap: wrap;
  }
  
  .breadcrumb span {
    color: #3498db;
    font-weight: 600;
    cursor: pointer;
    padding: 5px 10px;
    border-radius: 8px;
    transition: all 0.2s;
  }
  
  .breadcrumb span:hover {
    background: #e3f2fd;
    text-decoration: none;
  }
  
  .breadcrumb .separator {
    color: #adb5bd;
  }
  
  .file-explorer {
    padding: 30px;
    min-height: 500px;
  }
  
  .view-toggle {
    display: flex;
    justify-content: flex-end;
    margin-bottom: 20px;
    gap: 10px;
  }
  
  .view-btn {
    background: white;
    border: 2px solid #e9ecef;
    padding: 8px 15px;
    border-radius: 8px;
    cursor: pointer;
    color: #6c757d;
    transition: all 0.2s;
  }
  
  .view-btn.active {
    background: #3498db;
    color: white;
    border-color: #3498db;
  }
  
  /* Memory Card Style */
  .memory-cards {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 20px;
  }
  
  .memory-card {
    background: white;
    border-radius: 16px;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
    padding: 20px;
    transition: all 0.3s ease;
    cursor: pointer;
    border: 2px solid transparent;
    position: relative;
    overflow: hidden;
  }
  
  .memory-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(135deg, #3498db 0%, #2c3e50 100%);
  }
  
  .memory-card.folder::before {
    background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
  }
  
  .memory-card.local-file {
    border: 2px dashed #27ae60;
  }
  
  .memory-card.local-file::before {
    background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
  }
  
  .memory-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
    border-color: #3498db;
  }
  
  .memory-card.folder:hover {
    border-color: #f39c12;
  }
  
  .memory-card.local-file:hover {
    border-color: #27ae60;
  }
  
  .card-icon {
    text-align: center;
    margin-bottom: 15px;
    font-size: 48px;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .folder .card-icon {
    color: #f39c12;
  }
  
  .file .card-icon {
    color: #3498db;
  }
  
  .local-file .card-icon {
    color: #27ae60;
  }
  
  .card-content {
    text-align: center;
  }
  
  .card-name {
    font-weight: 600;
    font-size: 16px;
    margin-bottom: 8px;
    color: #2c3e50;
    word-break: break-word;
  }
  
  .card-name small {
    font-size: 12px;
    color: #27ae60;
    font-weight: normal;
  }
  
  .card-info {
    font-size: 12px;
    color: #6c757d;
    margin-bottom: 12px;
  }
  
  .card-actions {
    display: flex;
    justify-content: center;
    gap: 10px;
    opacity: 0;
    transition: opacity 0.2s;
  }
  
  .memory-card:hover .card-actions {
    opacity: 1;
  }
  
  .card-btn {
    background: #f8f9fa;
    border: none;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s;
    color: #6c757d;
  }
  
  .card-btn:hover {
    background: #3498db;
    color: white;
    transform: scale(1.1);
  }
  
  .card-btn.download:hover {
    background: #27ae60;
  }
  
  .card-btn.delete:hover {
    background: #e74c3c;
  }
  
  .upload-section {
    padding: 30px;
    border-top: 1px solid #e9ecef;
    background: #f8f9fa;
  }
  
  .upload-area {
    border: 3px dashed #ced4da;
    border-radius: 16px;
    padding: 40px;
    text-align: center;
    transition: all 0.3s;
    cursor: pointer;
    background: white;
  }
  
  .upload-area:hover {
    border-color: #3498db;
    background: #e8f4fd;
    transform: translateY(-5px);
  }
  
  .upload-area.dragover {
    border-color: #27ae60;
    background: #e8f6f3;
    transform: scale(1.02);
  }
  
  .upload-area i {
    font-size: 64px;
    color: #3498db;
    margin-bottom: 20px;
  }
  
  .upload-area h3 {
    margin-bottom: 15px;
    color: #2c3e50;
    font-size: 24px;
  }
  
  .upload-area p {
    color: #6c757d;
    margin-bottom: 20px;
    font-size: 16px;
  }
  
  .upload-btn {
    background: linear-gradient(135deg, #3498db 0%, #2c3e50 100%);
    color: white;
    border: none;
    padding: 12px 30px;
    border-radius: 50px;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    gap: 10px;
    font-size: 16px;
    font-weight: 600;
    transition: all 0.3s;
    box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
  }
  
  .upload-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 20px rgba(52, 152, 219, 0.6);
  }
  
  .file-input {
    display: none;
  }
  
  .loading {
    grid-column: 1 / -1;
    text-align: center;
    padding: 40px;
    color: #6c757d;
    font-style: italic;
  }
  
  .empty-folder {
    grid-column: 1 / -1;
    text-align: center;
    padding: 60px 20px;
    color: #adb5bd;
  }
  
  .empty-folder i {
    font-size: 80px;
    margin-bottom: 20px;
    opacity: 0.5;
  }
  
  .empty-folder h3 {
    font-size: 24px;
    margin-bottom: 10px;
    color: #6c757d;
  }
  
  footer {
    background: #2c3e50;
    padding: 25px 30px;
    text-align: center;
    font-size: 14px;
    color: #bdc3c7;
    border-top: 1px solid #34495e;
  }
  
  footer a {
    color: #3498db;
    text-decoration: none;
    font-weight: 600;
  }
  
  footer a:hover {
    text-decoration: underline;
  }
  
  /* Modal Styles */
  .modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    z-index: 1000;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(5px);
  }
  
  .modal-content {
    background: white;
    padding: 40px;
    border-radius: 20px;
    max-width: 500px;
    width: 90%;
    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
    text-align: center;
    position: relative;
  }
  
  .modal-close {
    position: absolute;
    top: 15px;
    right: 20px;
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
    color: #6c757d;
  }
  
  .modal h3 {
    margin-bottom: 15px;
    color: #2c3e50;
    font-size: 24px;
  }
  
  .modal p {
    margin-bottom: 25px;
    color: #6c757d;
    line-height: 1.6;
  }
  
  .modal-buttons {
    display: flex;
    gap: 15px;
    justify-content: center;
  }
  
  .modal-btn {
    padding: 12px 25px;
    border: none;
    border-radius: 50px;
    cursor: pointer;
    font-size: 16px;
    font-weight: 600;
    transition: all 0.3s;
    min-width: 120px;
  }
  
  .modal-btn.confirm {
    background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
    color: white;
  }
  
  .modal-btn.confirm:hover {
    transform: translateY(-3px);
    box-shadow: 0 5px 15px rgba(39, 174, 96, 0.4);
  }
  
  .modal-btn.cancel {
    background: #f8f9fa;
    color: #6c757d;
    border: 2px solid #e9ecef;
  }
  
  .modal-btn.cancel:hover {
    background: #e9ecef;
  }
  
  /* Responsive Design */
  @media (max-width: 768px) {
    .memory-cards {
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    }
    
    header {
      flex-direction: column;
      gap: 20px;
      text-align: center;
    }
    
    .header-stats {
      justify-content: center;
    }
    
    .breadcrumb {
      font-size: 14px;
    }
  }
</style>
</head>
<body>

<div class="container">
  <header>
    <div class="header-left">
      <div class="logo">
        <i class="fas fa-sd-card"></i>
      </div>
      <h1>Memory Card Explorer</h1>
    </div>
    
    <div class="header-stats">
      <div class="stat">
        <div class="stat-value" id="folderCount">0</div>
        <div class="stat-label">Folders</div>
      </div>
      <div class="stat">
        <div class="stat-value" id="fileCount">0</div>
        <div class="stat-label">Files</div>
      </div>
      <div class="stat">
        <div class="stat-value" id="totalSize">0 MB</div>
        <div class="stat-label">Total Size</div>
      </div>
    </div>
    
    <div class="action-buttons">
      <button class="action-btn back-btn" id="backBtn" disabled>
        <i class="fas fa-arrow-left"></i> Back
      </button>
      <button class="action-btn" id="uploadBtn">
        <i class="fas fa-upload"></i> Upload
      </button>
      <button class="action-btn" id="newFolderBtn">
        <i class="fas fa-folder-plus"></i> New Folder
      </button>
    </div>
  </header>
  
  <div class="breadcrumb" id="breadcrumb">
    <span class="breadcrumb-item" data-path="">Home</span>
    <span class="separator">/</span>
    <span class="breadcrumb-item" data-path="calculator">Calculator</span>
  </div>
  
  <div class="file-explorer">
    <div class="view-toggle">
      <button class="view-btn active" id="cardViewBtn">
        <i class="fas fa-th-large"></i> Cards
      </button>
      <button class="view-btn" id="listViewBtn">
        <i class="fas fa-list"></i> List
      </button>
    </div>
    
    <div class="memory-cards" id="fileGrid">
      <div class="loading">
        <i class="fas fa-spinner fa-spin"></i> Loading files...
      </div>
    </div>
  </div>
  
  <div class="upload-section">
    <div class="upload-area" id="uploadArea">
      <i class="fas fa-cloud-upload-alt"></i>
      <h3>Upload Files to This Folder</h3>
      <p>Drag & drop files here or click to browse</p>
      <button class="upload-btn">
        <i class="fas fa-folder-open"></i> Select Files
      </button>
      <input type="file" class="file-input" id="fileInput" multiple>
    </div>
  </div>
  
  <footer>
    Memory Card Explorer &copy; 2023 | Repository: <a href="https://github.com/tevrasite/Tevra" target="_blank">github.com/tevrasite/Tevra</a>
  </footer>
</div>

<!-- Upload Modal -->
<div class="modal" id="uploadModal">
  <div class="modal-content">
    <button class="modal-close" id="closeModal">&times;</button>
    <h3>Upload Files</h3>
    <p id="uploadModalText">You are about to upload <span id="fileCountText">0</span> file(s) to <strong id="currentPathText">calculator</strong>.</p>
    <div class="modal-buttons">
      <button class="modal-btn cancel" id="cancelUpload">Cancel</button>
      <button class="modal-btn confirm" id="confirmUpload">Upload Files</button>
    </div>
  </div>
</div>

<!-- New Folder Modal -->
<div class="modal" id="folderModal">
  <div class="modal-content">
    <button class="modal-close" id="closeFolderModal">&times;</button>
    <h3>Create New Folder</h3>
    <p>Enter folder name:</p>
    <input type="text" id="folderNameInput" placeholder="Folder name" style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 16px; margin: 15px 0;">
    <div class="modal-buttons">
      <button class="modal-btn cancel" id="cancelFolder">Cancel</button>
      <button class="modal-btn confirm" id="confirmFolder">Create Folder</button>
    </div>
  </div>
</div>

<!-- File Info Modal -->
<div class="modal" id="fileInfoModal">
  <div class="modal-content">
    <button class="modal-close" id="closeFileModal">&times;</button>
    <div id="fileModalContent">
      <!-- Content will be inserted dynamically -->
    </div>
  </div>
</div>

<script>
const owner = "tevrasite";
const repo = "Tevra";
const basePath = "calculator";
const branch = "07fcf93090402bd5f96c39de79590f4d73d9bedd";

const fileGrid = document.getElementById("fileGrid");
const breadcrumb = document.getElementById("breadcrumb");
const backBtn = document.getElementById("backBtn");
const uploadBtn = document.getElementById("uploadBtn");
const newFolderBtn = document.getElementById("newFolderBtn");
const uploadArea = document.getElementById("uploadArea");
const fileInput = document.getElementById("fileInput");
const uploadModal = document.getElementById("uploadModal");
const folderModal = document.getElementById("folderModal");
const cancelUpload = document.getElementById("cancelUpload");
const confirmUpload = document.getElementById("confirmUpload");
const closeModal = document.getElementById("closeModal");
const closeFolderModal = document.getElementById("closeFolderModal");
const folderNameInput = document.getElementById("folderNameInput");
const cancelFolder = document.getElementById("cancelFolder");
const confirmFolder = document.getElementById("confirmFolder");
const fileInfoModal = document.getElementById("fileInfoModal");
const closeFileModal = document.getElementById("closeFileModal");
const folderCount = document.getElementById("folderCount");
const fileCount = document.getElementById("fileCount");
const totalSize = document.getElementById("totalSize");
const cardViewBtn = document.getElementById("cardViewBtn");
const listViewBtn = document.getElementById("listViewBtn");
const uploadModalText = document.getElementById("uploadModalText");
const fileCountText = document.getElementById("fileCountText");
const currentPathText = document.getElementById("currentPathText");

let currentPath = basePath;
let pathHistory = [basePath];
let currentView = 'cards';

// Function to get file icon based on extension
function getFileIcon(filename) {
  const ext = filename.split('.').pop().toLowerCase();
  const iconMap = {
    'js': 'fa-file-code',
    'html': 'fa-file-code',
    'css': 'fa-file-code',
    'json': 'fa-file-code',
    'md': 'fa-file-alt',
    'txt': 'fa-file-alt',
    'pdf': 'fa-file-pdf',
    'jpg': 'fa-file-image',
    'jpeg': 'fa-file-image',
    'png': 'fa-file-image',
    'gif': 'fa-file-image',
    'svg': 'fa-file-image',
    'zip': 'fa-file-archive',
    'rar': 'fa-file-archive',
    '7z': 'fa-file-archive',
    'doc': 'fa-file-word',
    'docx': 'fa-file-word',
    'xls': 'fa-file-excel',
    'xlsx': 'fa-file-excel',
    'ppt': 'fa-file-powerpoint',
    'pptx': 'fa-file-powerpoint'
  };
  
  return iconMap[ext] || 'fa-file';
}

// Format file size
function formatFileSize(bytes) {
  if (!bytes || bytes === 0) return '0 Bytes';
  const k = 1024;
  const sizes = ['Bytes', 'KB', 'MB', 'GB'];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
}

// Update breadcrumb
function updateBreadcrumb() {
  const pathParts = currentPath.split('/');
  let breadcrumbHTML = '';
  
  // Add home
  breadcrumbHTML += `<span class="breadcrumb-item" data-path="">Home</span>`;
  
  // Add path parts
  pathParts.forEach((part, index) => {
    const accumulatedPath = pathParts.slice(0, index + 1).join('/');
    breadcrumbHTML += `<span class="separator">/</span>`;
    breadcrumbHTML += `<span class="breadcrumb-item" data-path="${accumulatedPath}">${part}</span>`;
  });
  
  breadcrumb.innerHTML = breadcrumbHTML;
  
  // Add event listeners to breadcrumb items
  document.querySelectorAll('.breadcrumb-item').forEach(item => {
    item.addEventListener('click', () => {
      const path = item.getAttribute('data-path');
      if (path !== currentPath) {
        navigateToPath(path);
      }
    });
  });
  
  // Update back button state
  backBtn.disabled = pathHistory.length <= 1;
}

// Navigate to a specific path
function navigateToPath(path) {
  currentPath = path;
  pathHistory.push(path);
  updateBreadcrumb();
  loadFiles();
}

// Go back to previous path
function goBack() {
  if (pathHistory.length > 1) {
    pathHistory.pop(); // Remove current path
    currentPath = pathHistory[pathHistory.length - 1];
    updateBreadcrumb();
    loadFiles();
  }
}

// Fetch files and folders from GitHub API
async function fetchFiles(folderPath) {
  const apiUrl = `https://api.github.com/repos/${owner}/${repo}/contents/${folderPath}?ref=${branch}`;
  try {
    const res = await fetch(apiUrl);
    const data = await res.json();

    if (Array.isArray(data)) {
      // Sort folders first, then files
      data.sort((a, b) => {
        if (a.type === b.type) return a.name.localeCompare(b.name);
        return a.type === "dir" ? -1 : 1;
      });

      return data;
    } else {
      return [];
    }
  } catch (error) {
    console.error(error);
    return [];
  }
}

// Load files for current path
async function loadFiles() {
  // Show loading
  fileGrid.innerHTML = '<div class="loading"><i class="fas fa-spinner fa-spin"></i> Loading files...</div>';
  
  const files = await fetchFiles(currentPath);
  
  // Clear grid
  fileGrid.innerHTML = '';
  
  // Count folders and files
  let folderCounter = 0;
  let fileCounter = 0;
  let totalBytes = 0;
  
  // Load GitHub files
  files.forEach(item => {
    if (item.type === "dir") {
      folderCounter++;
      createFolderCard(item);
    } else {
      fileCounter++;
      totalBytes += item.size || 0;
      createFileCard(item);
    }
  });
  
  // Load local files
  const localFiles = getLocalFiles();
  localFiles.forEach(file => {
    if (file.path === currentPath) {
      fileCounter++;
      totalBytes += file.size || 0;
      createLocalFileCard(file);
    }
  });
  
  // Load local folders
  const localFolders = getLocalFolders();
  localFolders.forEach(folder => {
    if (folder.path === currentPath) {
      folderCounter++;
      createLocalFolderCard(folder);
    }
  });
  
  if (folderCounter === 0 && fileCounter === 0) {
    fileGrid.innerHTML = `
      <div class="empty-folder">
        <i class="far fa-folder-open"></i>
        <h3>This folder is empty</h3>
        <p>Upload files or create folders to get started</p>
      </div>
    `;
  }
  
  updateStats(folderCounter, fileCounter, totalBytes);
}

// Update statistics
function updateStats(folders, files, bytes) {
  folderCount.textContent = folders;
  fileCount.textContent = files;
  totalSize.textContent = formatFileSize(bytes);
}

// Get local files from localStorage
function getLocalFiles() {
  const localFiles = [];
  for (let i = 0; i < localStorage.length; i++) {
    const key = localStorage.key(i);
    if (key.startsWith('local_file_')) {
      try {
        const fileData = JSON.parse(localStorage.getItem(key));
        localFiles.push(fileData);
      } catch (e) {
        console.error('Error parsing local file:', e);
      }
    }
  }
  return localFiles;
}

// Get local folders from localStorage
function getLocalFolders() {
  const localFolders = [];
  for (let i = 0; i < localStorage.length; i++) {
    const key = localStorage.key(i);
    if (key.startsWith('local_folder_')) {
      try {
        const folderData = JSON.parse(localStorage.getItem(key));
        localFolders.push(folderData);
      } catch (e) {
        console.error('Error parsing local folder:', e);
      }
    }
  }
  return localFolders;
}

// Create folder card for GitHub folders
function createFolderCard(item) {
  const card = document.createElement('div');
  card.className = 'memory-card folder';
  card.innerHTML = `
    <div class="card-icon">
      <i class="fas fa-folder"></i>
    </div>
    <div class="card-content">
      <div class="card-name">${item.name}</div>
      <div class="card-info">GitHub Folder</div>
      <div class="card-actions">
        <button class="card-btn open" title="Open Folder">
          <i class="fas fa-folder-open"></i>
        </button>
        <button class="card-btn info" title="Folder Info">
          <i class="fas fa-info-circle"></i>
        </button>
      </div>
    </div>
  `;
  
  // Open folder on click
  card.addEventListener('click', (e) => {
    if (!e.target.closest('.card-btn')) {
      navigateToPath(item.path);
    }
  });
  
  // Info button
  card.querySelector('.card-btn.info').addEventListener('click', (e) => {
    e.stopPropagation();
    showFolderInfo(item);
  });
  
  fileGrid.appendChild(card);
}

// Create local folder card
function createLocalFolderCard(folder) {
  const card = document.createElement('div');
  card.className = 'memory-card folder local-file';
  card.innerHTML = `
    <div class="card-icon">
      <i class="fas fa-folder"></i>
    </div>
    <div class="card-content">
      <div class="card-name">${folder.name} <small>(Local)</small></div>
      <div class="card-info">Local Folder</div>
      <div class="card-actions">
        <button class="card-btn open" title="Open Folder">
          <i class="fas fa-folder-open"></i>
        </button>
        <button class="card-btn delete" title="Delete Folder">
          <i class="fas fa-trash"></i>
        </button>
      </div>
    </div>
  `;
  
  // Open folder on click
  card.addEventListener('click', (e) => {
    if (!e.target.closest('.card-btn')) {
      navigateToPath(folder.fullPath);
    }
  });
  
  // Delete button
  card.querySelector('.card-btn.delete').addEventListener('click', (e) => {
    e.stopPropagation();
    deleteLocalFolder(folder.id);
  });
  
  fileGrid.appendChild(card);
}

// Create file card for GitHub files
function createFileCard(item) {
  const fileIcon = getFileIcon(item.name);
  const fileSize = formatFileSize(item.size || 0);
  
  const card = document.createElement('div');
  card.className = 'memory-card file';
  card.innerHTML = `
    <div class="card-icon">
      <i class="far ${fileIcon}"></i>
    </div>
    <div class="card-content">
      <div class="card-name">${item.name}</div>
      <div class="card-info">${fileSize} • GitHub</div>
      <div class="card-actions">
        <button class="card-btn info" title="File Info">
          <i class="fas fa-info-circle"></i>
        </button>
        <button class="card-btn download" title="Download File">
          <i class="fas fa-download"></i>
        </button>
      </div>
    </div>
  `;
  
  // View file on click
  card.addEventListener('click', (e) => {
    if (!e.target.closest('.card-btn')) {
      window.open(item.html_url, '_blank');
    }
  });
  
  // Info button
  card.querySelector('.card-btn.info').addEventListener('click', (e) => {
    e.stopPropagation();
    showFileInfo(item);
  });
  
  // Download button
  card.querySelector('.card-btn.download').addEventListener('click', (e) => {
    e.stopPropagation();
    window.open(item.download_url || item.html_url, '_blank');
  });
  
  fileGrid.appendChild(card);
}

// Create local file card
function createLocalFileCard(fileData) {
  const fileIcon = getFileIcon(fileData.name);
  const fileSize = formatFileSize(fileData.size);
  
  const card = document.createElement('div');
  card.className = 'memory-card file local-file';
  card.innerHTML = `
    <div class="card-icon">
      <i class="far ${fileIcon}"></i>
    </div>
    <div class="card-content">
      <div class="card-name">${fileData.name} <small>(Local)</small></div>
      <div class="card-info">${fileSize} • Local</div>
      <div class="card-actions">
        <button class="card-btn info" title="File Info">
          <i class="fas fa-info-circle"></i>
        </button>
        <button class="card-btn download" title="Download File">
          <i class="fas fa-download"></i>
        </button>
        <button class="card-btn delete" title="Delete File">
          <i class="fas fa-trash"></i>
        </button>
      </div>
    </div>
  `;
  
  // View file on click
  card.addEventListener('click', (e) => {
    if (!e.target.closest('.card-btn')) {
      // For local files, download when clicked
      downloadLocalFile(fileData);
    }
  });
  
  // Info button
  card.querySelector('.card-btn.info').addEventListener('click', (e) => {
    e.stopPropagation();
    showLocalFileInfo(fileData);
  });
  
  // Download button
  card.querySelector('.card-btn.download').addEventListener('click', (e) => {
    e.stopPropagation();
    downloadLocalFile(fileData);
  });
  
  // Delete button
  card.querySelector('.card-btn.delete').addEventListener('click', (e) => {
    e.stopPropagation();
    deleteLocalFile(fileData.id);
  });
  
  fileGrid.appendChild(card);
}

// Upload file to local storage
function uploadToLocal(file, path) {
  return new Promise((resolve) => {
    const reader = new FileReader();
    reader.onload = function(e) {
      const fileData = {
        id: `local_file_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
        name: file.name,
        type: file.type,
        size: file.size,
        content: e.target.result,
        path: path,
        uploadedAt: new Date().toISOString(),
        isLocal: true
      };
      
      localStorage.setItem(fileData.id, JSON.stringify(fileData));
      resolve(fileData);
    };
    reader.readAsDataURL(file);
  });
}

// Create local folder
function createLocalFolder(folderName, path) {
  const folderData = {
    id: `local_folder_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
    name: folderName,
    path: path,
    fullPath: path ? `${path}/${folderName}` : folderName,
    createdAt: new Date().toISOString(),
    isLocal: true
  };
  
  localStorage.setItem(folderData.id, JSON.stringify(folderData));
  return folderData;
}

// Download local file
function downloadLocalFile(fileData) {
  const link = document.createElement('a');
  link.href = fileData.content;
  link.download = fileData.name;
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}

// Delete local file
function deleteLocalFile(fileId) {
  if (confirm('Are you sure you want to delete this file?')) {
    localStorage.removeItem(fileId);
    loadFiles();
  }
}

// Delete local folder
function deleteLocalFolder(folderId) {
  if (confirm('Are you sure you want to delete this folder and all its contents?')) {
    // Delete the folder
    localStorage.removeItem(folderId);
    
    // Delete all files in this folder
    const folderData = JSON.parse(localStorage.getItem(folderId));
    if (folderData) {
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key.startsWith('local_file_')) {
          const fileData = JSON.parse(localStorage.getItem(key));
          if (fileData.path === folderData.fullPath) {
            localStorage.removeItem(key);
          }
        }
      }
    }
    
    loadFiles();
  }
}

// Show file information for GitHub files
function showFileInfo(item) {
  const fileIcon = getFileIcon(item.name);
  const fileSize = formatFileSize(item.size || 0);
  
  document.getElementById('fileModalContent').innerHTML = `
    <div class="card-icon">
      <i class="far ${fileIcon}"></i>
    </div>
    <h3>${item.name}</h3>
    <div style="text-align: left; margin-top: 20px;">
      <p><strong>Type:</strong> GitHub File</p>
      <p><strong>Size:</strong> ${fileSize}</p>
      <p><strong>Path:</strong> ${item.path}</p>
      <p><strong>SHA:</strong> ${item.sha.substring(0, 8)}...</p>
    </div>
    <div class="modal-buttons" style="margin-top: 25px;">
      <button class="modal-btn cancel" onclick="fileInfoModal.style.display='none'">Close</button>
      <button class="modal-btn confirm" onclick="window.open('${item.html_url}', '_blank')">View on GitHub</button>
    </div>
  `;
  
  fileInfoModal.style.display = 'flex';
}

// Show file information for local files
function showLocalFileInfo(fileData) {
  const fileIcon = getFileIcon(fileData.name);
  const fileSize = formatFileSize(fileData.size);
  const uploadDate = new Date(fileData.uploadedAt).toLocaleString();
  
  document.getElementById('fileModalContent').innerHTML = `
    <div class="card-icon">
      <i class="far ${fileIcon}"></i>
    </div>
    <h3>${fileData.name}</h3>
    <div style="text-align: left; margin-top: 20px;">
      <p><strong>Type:</strong> Local File</p>
      <p><strong>Size:</strong> ${fileSize}</p>
      <p><strong>Path:</strong> ${fileData.path}</p>
      <p><strong>Uploaded:</strong> ${uploadDate}</p>
    </div>
    <div class="modal-buttons" style="margin-top: 25px;">
      <button class="modal-btn cancel" onclick="fileInfoModal.style.display='none'">Close</button>
      <button class="modal-btn confirm" onclick="downloadLocalFile(${JSON.stringify(fileData).replace(/"/g, '&quot;')})">Download File</button>
    </div>
  `;
  
  fileInfoModal.style.display = 'flex';
}

// Show folder information
function showFolderInfo(item) {
  document.getElementById('fileModalContent').innerHTML = `
    <div class="card-icon">
      <i class="fas fa-folder"></i>
    </div>
    <h3>${item.name}</h3>
    <div style="text-align: left; margin-top: 20px;">
      <p><strong>Type:</strong> GitHub Folder</p>
      <p><strong>Path:</strong> ${item.path}</p>
      <p><strong>SHA:</strong> ${item.sha.substring(0, 8)}...</p>
    </div>
    <div class="modal-buttons" style="margin-top: 25px;">
      <button class="modal-btn cancel" onclick="fileInfoModal.style.display='none'">Close</button>
      <button class="modal-btn confirm" onclick="window.open('${item.html_url}', '_blank')">View on GitHub</button>
    </div>
  `;
  
  fileInfoModal.style.display = 'flex';
}

// Upload functionality
function setupUpload() {
  // Click on upload area to trigger file input
  uploadArea.addEventListener('click', () => {
    fileInput.click();
  });
  
  // Upload button click
  uploadBtn.addEventListener('click', () => {
    fileInput.click();
  });
  
  // File input change
  fileInput.addEventListener('change', () => {
    const files = fileInput.files;
    if (files.length > 0) {
      fileCountText.textContent = files.length;
      currentPathText.textContent = currentPath;
      uploadModal.style.display = 'flex';
    }
  });
  
  // Drag and drop functionality
  uploadArea.addEventListener('dragover', (e) => {
    e.preventDefault();
    uploadArea.classList.add('dragover');
  });
  
  uploadArea.addEventListener('dragleave', () => {
    uploadArea.classList.remove('dragover');
  });
  
  uploadArea.addEventListener('drop', (e) => {
    e.preventDefault();
    uploadArea.classList.remove('dragover');
    fileInput.files = e.dataTransfer.files;
    const files = fileInput.files;
    if (files.length > 0) {
      fileCountText.textContent = files.length;
      currentPathText.textContent = currentPath;
      uploadModal.style.display = 'flex';
    }
  });
  
  // Cancel upload
  cancelUpload.addEventListener('click', () => {
    uploadModal.style.display = 'none';
    fileInput.value = '';
  });
  
  // Close modal
  closeModal.addEventListener('click', () => {
    uploadModal.style.display = 'none';
    fileInput.value = '';
  });
  
  // Confirm upload
  confirmUpload.addEventListener('click', async () => {
    const files = fileInput.files;
    if (files.length > 0) {
      // Upload each file
      const uploadPromises = Array.from(files).map(file => 
        uploadToLocal(file, currentPath)
      );
      
      await Promise.all(uploadPromises);
      
      // Success message
      alert(`Successfully uploaded ${files.length} file(s) to ${currentPath}`);
      
      // Reset and close
      fileInput.value = '';
      uploadModal.style.display = 'none';
      
      // Refresh file list
      loadFiles();
    }
  });
}

// New folder functionality
function setupNewFolder() {
  newFolderBtn.addEventListener('click', () => {
    folderNameInput.value = '';
    folderModal.style.display = 'flex';
    folderNameInput.focus();
  });
  
  closeFolderModal.addEventListener('click', () => {
    folderModal.style.display = 'none';
  });
  
  cancelFolder.addEventListener('click', () => {
    folderModal.style.display = 'none';
  });
  
  confirmFolder.addEventListener('click', () => {
    const folderName = folderNameInput.value.trim();
    if (folderName) {
      createLocalFolder(folderName, currentPath);
      folderModal.style.display = 'none';
      loadFiles();
    } else {
      alert('Please enter a folder name');
    }
  });
  
  // Allow pressing Enter to create folder
  folderNameInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
      confirmFolder.click();
    }
  });
}

// View toggle functionality
function setupViewToggle() {
  cardViewBtn.addEventListener('click', () => {
    if (currentView !== 'cards') {
      currentView = 'cards';
      cardViewBtn.classList.add('active');
      listViewBtn.classList.remove('active');
      fileGrid.className = 'memory-cards';
    }
  });
  
  listViewBtn.addEventListener('click', () => {
    if (currentView !== 'list') {
      currentView = 'list';
      listViewBtn.classList.add('active');
      cardViewBtn.classList.remove('active');
      fileGrid.className = 'file-list-view';
      alert('List view would be implemented here');
    }
  });
}

// Close file info modal
closeFileModal.addEventListener('click', () => {
  fileInfoModal.style.display = 'none';
});

// Initialize the application
function init() {
  updateBreadcrumb();
  loadFiles();
  setupUpload();
  setupNewFolder();
  setupViewToggle();
  
  // Back button event
  backBtn.addEventListener('click', goBack);
}

// Start the application
init();
</script>

</body>
</html>